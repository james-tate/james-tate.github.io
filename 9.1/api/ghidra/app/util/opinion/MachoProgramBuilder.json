{"implements":[],"javadoc":"Builds up a Mach-O {@link Program} by parsing the Mach-O headers.","static":false,"extends":"java.lang.Object","methods":[{"javadoc":"Creates a new {@link MachoProgramBuilder} based on the given information.\n@param program The {@link Program} to build up.\n@param provider The {@link ByteProvider} that contains the Mach-O's bytes.\n@param fileBytes Where the Mach-O's bytes came from.\n@param log The log.\n@param monitor A cancelable task monitor.","static":false,"name":"<init>","comment":"Creates a new MachoProgramBuilder based on the given information.","params":[{"type_long":"ghidra.program.model.listing.Program","name":"program","comment":"The Program to build up.","type_short":"Program"},{"type_long":"ghidra.app.util.bin.ByteProvider","name":"provider","comment":"The ByteProvider that contains the Mach-O's bytes.","type_short":"ByteProvider"},{"type_long":"ghidra.program.database.mem.FileBytes","name":"fileBytes","comment":"Where the Mach-O's bytes came from.","type_short":"FileBytes"},{"type_long":"ghidra.app.util.importer.MessageLog","name":"log","comment":"The log.","type_short":"MessageLog"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"A cancelable task monitor.","type_short":"TaskMonitor"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"Builds up a Mach-O {@link Program}.\n@param program The {@link Program} to build up.\n@param provider The {@link ByteProvider} that contains the Mach-O's bytes.\n@param fileBytes Where the Mach-O's bytes came from.\n@param log The log.\n@param monitor A cancelable task monitor.\n@throws Exception if a problem occurs.","static":true,"name":"buildProgram","comment":"Builds up a Mach-O Program.","params":[{"type_long":"ghidra.program.model.listing.Program","name":"program","comment":"The Program to build up.","type_short":"Program"},{"type_long":"ghidra.app.util.bin.ByteProvider","name":"provider","comment":"The ByteProvider that contains the Mach-O's bytes.","type_short":"ByteProvider"},{"type_long":"ghidra.program.database.mem.FileBytes","name":"fileBytes","comment":"Where the Mach-O's bytes came from.","type_short":"FileBytes"},{"type_long":"ghidra.app.util.importer.MessageLog","name":"log","comment":"The log.","type_short":"MessageLog"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"A cancelable task monitor.","type_short":"TaskMonitor"}],"throws":[{"type_long":"java.lang.Exception","comment":"if a problem occurs.","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"build","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"setImageBase","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processEntryPoint","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"Creates memory blocks for the given header.\n@param header The Mach-O header to process for memory block creation.\n@param source A name that represents where the memory blocks came from.\n@param processSections True to split segments into their sections.\n@param allowZeroAddr True if memory blocks at address 0 should be processed; otherwise, \n   false.\n@throws Exception If there was a problem processing the memory blocks.","static":false,"name":"processMemoryBlocks","comment":"Creates memory blocks for the given header.","params":[{"type_long":"ghidra.app.util.bin.format.macho.MachHeader","name":"header","comment":"The Mach-O header to process for memory block creation.","type_short":"MachHeader"},{"type_long":"java.lang.String","name":"source","comment":"A name that represents where the memory blocks came from.","type_short":"String"},{"type_long":"boolean","name":"processSections","comment":"True to split segments into their sections.","type_short":"boolean"},{"type_long":"boolean","name":"allowZeroAddr","comment":"True if memory blocks at address 0 should be processed; otherwise, \n   false.","type_short":"boolean"}],"throws":[{"type_long":"java.lang.Exception","comment":"If there was a problem processing the memory blocks.","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"Creates a memory with the provided attributes.  The block we wish to create may reside inside\n an already-created block. If this is the case, we split the outer block(s) that encompass our\n desired new block. This is the nature of Mach-O segments and sections (sections are\n contained in segments).\n@param name The name of the new block.\n@param start The starting address of the new block.\n@param dataOffset The provider offset of the new block.\n@param dataLength The length of the new block.\n@param comment A comment for the new block.\n@param source The source name of the new block.\n@param r True if the new block has read-permissions; otherwise, false.\n@param w True if the new block has write-permissions; otherwise, false.\n@param x True if the new block has execute-permissions; otherwise, false.\n@param zeroFill True if the new block is zero-filled; otherwise, false.  Newly created\n   zero-filled blocks will be uninitialized to safe space.\n@return The newly created (or split) memory block, or null if it failed to be created.\n@throws Exception If there was a problem creating the new memory block.","static":false,"name":"createMemoryBlock","comment":"Creates a memory with the provided attributes.  The block we wish to create may reside inside\n an already-created block. If this is the case, we split the outer block(s) that encompass our\n desired new block. This is the nature of Mach-O segments and sections (sections are\n contained in segments).","params":[{"type_long":"java.lang.String","name":"name","comment":"The name of the new block.","type_short":"String"},{"type_long":"ghidra.program.model.address.Address","name":"start","comment":"The starting address of the new block.","type_short":"Address"},{"type_long":"long","name":"dataOffset","comment":"The provider offset of the new block.","type_short":"long"},{"type_long":"long","name":"dataLength","comment":"The length of the new block.","type_short":"long"},{"type_long":"java.lang.String","name":"comment","comment":"A comment for the new block.","type_short":"String"},{"type_long":"java.lang.String","name":"source","comment":"The source name of the new block.","type_short":"String"},{"type_long":"boolean","name":"r","comment":"True if the new block has read-permissions; otherwise, false.","type_short":"boolean"},{"type_long":"boolean","name":"w","comment":"True if the new block has write-permissions; otherwise, false.","type_short":"boolean"},{"type_long":"boolean","name":"x","comment":"True if the new block has execute-permissions; otherwise, false.","type_short":"boolean"},{"type_long":"boolean","name":"zeroFill","comment":"True if the new block is zero-filled; otherwise, false.  Newly created\n   zero-filled blocks will be uninitialized to safe space.","type_short":"boolean"}],"throws":[{"type_long":"java.lang.Exception","comment":"If there was a problem creating the new memory block.","type_short":"Exception"}],"return":{"type_long":"ghidra.program.model.mem.MemoryBlock","comment":"The newly created (or split) memory block, or null if it failed to be created.","type_short":"MemoryBlock"}},{"javadoc":"","static":false,"name":"processUnsupportedLoadCommands","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processSymbolTables","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"The indirect symbols need to be applied across the IMPORT segment. The\n individual section do not really matter except the number of bytes\n between each symbol varies based on section.\n@throws Exception if there is a problem","static":false,"name":"processIndirectSymbols","comment":"The indirect symbols need to be applied across the IMPORT segment. The\n individual section do not really matter except the number of bytes\n between each symbol varies based on section.","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"if there is a problem","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"setRelocatableProperty","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processLibraries","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processProgramDescription","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"renameObjMsgSendRtpSymbol","comment":"","params":[],"throws":[{"type_long":"ghidra.util.exception.DuplicateNameException","comment":"","type_short":"DuplicateNameException"},{"type_long":"ghidra.util.exception.InvalidInputException","comment":"","type_short":"InvalidInputException"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processUndefinedSymbols","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processAbsoluteSymbols","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processDyldInfo","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"markupHeaders","comment":"","params":[{"type_long":"ghidra.app.util.bin.format.macho.MachHeader","name":"header","comment":"","type_short":"MachHeader"},{"type_long":"ghidra.program.model.address.Address","name":"headerAddr","comment":"","type_short":"Address"}],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"markupSections","comment":"","params":[],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"See crt.c from opensource.apple.com","static":false,"name":"processProgramVars","comment":"See crt.c from opensource.apple.com","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"loadSectionRelocations","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"loadExternalRelocations","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"loadLocalRelocations","comment":"","params":[],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"r_address is set to the offset from the vmaddr of the first LC_SEGMENT\n command. For MH_SPLIT_SEGS images, r_address is set to the the offset\n from the vmaddr of the first read-write LC_SEGMENT command.\n@return The relocation base address.","static":false,"name":"getRelocationBaseAddress","comment":"r_address is set to the offset from the vmaddr of the first LC_SEGMENT\n command. For MH_SPLIT_SEGS images, r_address is set to the the offset\n from the vmaddr of the first read-write LC_SEGMENT command.","params":[],"throws":[],"return":{"type_long":"ghidra.program.model.address.Address","comment":"The relocation base address.","type_short":"Address"}},{"javadoc":"","static":false,"name":"loadRelocation","comment":"","params":[{"type_long":"int","name":"relocationType","comment":"","type_short":"int"},{"type_long":"ghidra.app.util.bin.format.macho.RelocationInfo","name":"relocation","comment":"","type_short":"RelocationInfo"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"addLibrary","comment":"","params":[{"type_long":"java.lang.String","name":"library","comment":"","type_short":"String"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"getAddress","comment":"","params":[],"throws":[],"return":{"type_long":"ghidra.program.model.address.Address","comment":"","type_short":"Address"}},{"javadoc":"","static":false,"name":"getMemoryBlock","comment":"","params":[{"type_long":"ghidra.app.util.bin.format.macho.Section","name":"section","comment":"","type_short":"Section"}],"throws":[],"return":{"type_long":"ghidra.program.model.mem.MemoryBlock","comment":"","type_short":"MemoryBlock"}},{"javadoc":"","static":false,"name":"markupBlock","comment":"","params":[{"type_long":"ghidra.program.model.mem.MemoryBlock","name":"block","comment":"","type_short":"MemoryBlock"},{"type_long":"ghidra.program.model.data.DataType","name":"datatype","comment":"","type_short":"DataType"}],"throws":[{"type_long":"java.lang.Exception","comment":"","type_short":"Exception"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"To indicate a pointer to THUMB code, the compiler generates an address\n that is 1 more than the actual destination. For example, a pointer to\n THUMB code at 0x1000 would be generated as 0x1001. We detect this case\n and correct the pointer reference so that Ghidra will disassemble\n correctly.\n\n We also need to set the TMode bit!\n@param address the address\n@throws AddressOverflowException if there was a problem","static":false,"name":"fixupThumbPointers","comment":"To indicate a pointer to THUMB code, the compiler generates an address\n that is 1 more than the actual destination. For example, a pointer to\n THUMB code at 0x1000 would be generated as 0x1001. We detect this case\n and correct the pointer reference so that Ghidra will disassemble\n correctly.\n\n We also need to set the TMode bit!","params":[{"type_long":"ghidra.program.model.address.Address","name":"address","comment":"the address","type_short":"Address"}],"throws":[{"type_long":"ghidra.program.model.address.AddressOverflowException","comment":"if there was a problem","type_short":"AddressOverflowException"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"markAsThumb","comment":"","params":[{"type_long":"ghidra.program.model.address.Address","name":"address","comment":"","type_short":"Address"}],"throws":[{"type_long":"ghidra.program.model.listing.ContextChangeException","comment":"","type_short":"ContextChangeException"},{"type_long":"ghidra.program.model.address.AddressOverflowException","comment":"","type_short":"AddressOverflowException"}],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processLazyPointerSection","comment":"","params":[{"type_long":"ghidra.program.model.address.AddressSetView","name":"set","comment":"","type_short":"AddressSetView"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"createNamespaceForSection","comment":"","params":[{"type_long":"ghidra.app.util.bin.format.macho.Section","name":"section","comment":"","type_short":"Section"}],"throws":[],"return":{"type_long":"ghidra.program.model.symbol.Namespace","comment":"","type_short":"Namespace"}},{"javadoc":"","static":false,"name":"createNamespace","comment":"","params":[{"type_long":"java.lang.String","name":"namespaceName","comment":"","type_short":"String"}],"throws":[],"return":{"type_long":"ghidra.program.model.symbol.Namespace","comment":"","type_short":"Namespace"}},{"javadoc":"","static":false,"name":"generateValidName","comment":"","params":[{"type_long":"java.lang.String","name":"name","comment":"","type_short":"String"}],"throws":[],"return":{"type_long":"java.lang.String","comment":"","type_short":"String"}},{"javadoc":"","static":false,"name":"getSectionsWithTypes","comment":"","params":[{"type_long":"int[]","name":"sectionTypes","comment":"","type_short":"int[]"}],"throws":[],"return":{"type_long":"java.util.List<ghidra.app.util.bin.format.macho.Section>","comment":"","type_short":"List"}},{"javadoc":"create a one-byte function, so that when the code is analyzed,\n it will be disassembled, and the function created with the correct body.\n@param name the name of the function\n@param address location to create the function","static":false,"name":"createOneByteFunction","comment":"create a one-byte function, so that when the code is analyzed,\n it will be disassembled, and the function created with the correct body.","params":[{"type_long":"java.lang.String","name":"name","comment":"the name of the function","type_short":"String"},{"type_long":"ghidra.program.model.address.Address","name":"address","comment":"location to create the function","type_short":"Address"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"processSectionRelocation_x86","comment":"","params":[{"type_long":"ghidra.app.util.bin.format.macho.Section","name":"relocationSection","comment":"","type_short":"Section"},{"type_long":"ghidra.app.util.bin.format.macho.RelocationInfo","name":"relocation","comment":"","type_short":"RelocationInfo"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"getDataConverter","comment":"","params":[],"throws":[],"return":{"type_long":"ghidra.util.DataConverter","comment":"","type_short":"DataConverter"}},{"javadoc":"","static":false,"name":"addToRelocationTable","comment":"","params":[{"type_long":"ghidra.app.util.bin.format.macho.Section","name":"relocationSection","comment":"","type_short":"Section"},{"type_long":"ghidra.app.util.bin.format.macho.RelocationInfo","name":"relocation","comment":"","type_short":"RelocationInfo"},{"type_long":"boolean","name":"handled","comment":"","type_short":"boolean"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"getOriginalRelocationBytes","comment":"","params":[{"type_long":"ghidra.app.util.bin.format.macho.RelocationInfo","name":"relocation","comment":"","type_short":"RelocationInfo"},{"type_long":"ghidra.program.model.address.Address","name":"relocationAddress","comment":"","type_short":"Address"}],"throws":[],"return":{"type_long":"byte[]","comment":"","type_short":"byte[]"}}],"name":"MachoProgramBuilder","comment":"Builds up a Mach-O Program by parsing the Mach-O headers.","fields":[{"type_long":"java.lang.String","javadoc":"","static":true,"name":"BLOCK_SOURCE_NAME","comment":"","type_short":"String","constant_value":"\"Mach-O Loader\""},{"type_long":"ghidra.app.util.bin.format.macho.MachHeader","javadoc":"","static":false,"name":"machoHeader","comment":"","type_short":"MachHeader","constant_value":null},{"type_long":"ghidra.program.model.listing.Program","javadoc":"","static":false,"name":"program","comment":"","type_short":"Program","constant_value":null},{"type_long":"ghidra.app.util.bin.ByteProvider","javadoc":"","static":false,"name":"provider","comment":"","type_short":"ByteProvider","constant_value":null},{"type_long":"ghidra.program.database.mem.FileBytes","javadoc":"","static":false,"name":"fileBytes","comment":"","type_short":"FileBytes","constant_value":null},{"type_long":"ghidra.app.util.importer.MessageLog","javadoc":"","static":false,"name":"log","comment":"","type_short":"MessageLog","constant_value":null},{"type_long":"ghidra.util.task.TaskMonitor","javadoc":"","static":false,"name":"monitor","comment":"","type_short":"TaskMonitor","constant_value":null},{"type_long":"ghidra.program.model.mem.Memory","javadoc":"","static":false,"name":"memory","comment":"","type_short":"Memory","constant_value":null},{"type_long":"ghidra.program.model.listing.Listing","javadoc":"","static":false,"name":"listing","comment":"","type_short":"Listing","constant_value":null},{"type_long":"ghidra.program.model.address.AddressSpace","javadoc":"","static":false,"name":"space","comment":"","type_short":"AddressSpace","constant_value":null}]}
