{"implements":[],"javadoc":"Command for analyzing the Stack; the command is run in the background.\n NOTE: referenced thunk-functions should be created prior to this command","static":false,"extends":"ghidra.framework.cmd.BackgroundCommand","methods":[{"javadoc":"Constructs a new command for analyzing the Stack.\n@param entries and address set indicating the entry points of functions that have \n stacks to be analyzed.\n@param forceProcessing flag to force processing of stack references even if the stack\n           has already been defined.","static":false,"name":"<init>","comment":"Constructs a new command for analyzing the Stack.","params":[{"type_long":"ghidra.program.model.address.AddressSetView","name":"entries","comment":"and address set indicating the entry points of functions that have \n stacks to be analyzed.","type_short":"AddressSetView"},{"type_long":"boolean","name":"forceProcessing","comment":"flag to force processing of stack references even if the stack\n           has already been defined.","type_short":"boolean"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"Constructs a new command for analyzing the Stack.\n@param entry the entry point of the function that contains the stack to\n           be analyzed.\n@param forceProcessing flag to force processing of stack references even if the stack\n           has already been defined.","static":false,"name":"<init>","comment":"Constructs a new command for analyzing the Stack.","params":[{"type_long":"ghidra.program.model.address.Address","name":"entry","comment":"the entry point of the function that contains the stack to\n           be analyzed.","type_short":"Address"},{"type_long":"boolean","name":"forceProcessing","comment":"flag to force processing of stack references even if the stack\n           has already been defined.","type_short":"boolean"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"<init>","comment":"","params":[{"type_long":"ghidra.program.model.address.AddressSetView","name":"entries","comment":"","type_short":"AddressSetView"},{"type_long":"boolean","name":"doParameterAnalysis","comment":"","type_short":"boolean"},{"type_long":"boolean","name":"doLocalAnalysis","comment":"","type_short":"boolean"},{"type_long":"boolean","name":"forceProcessing","comment":"","type_short":"boolean"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"@see ghidra.framework.cmd.BackgroundCommand#applyTo(ghidra.framework.model.DomainObject, ghidra.util.task.TaskMonitor)","static":false,"name":"applyTo","comment":"","params":[{"type_long":"ghidra.framework.model.DomainObject","name":"obj","comment":"","type_short":"DomainObject"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"","type_short":"TaskMonitor"}],"throws":[],"return":{"type_long":"boolean","comment":"","type_short":"boolean"}},{"javadoc":"Analyze a function to build a stack frame based on stack references.\n@param entry The address of the entry point for the new function\n@param monitor the task monitor that is checked to see if the command has\n been cancelled.\n@throws CancelledException if the user canceled this command","static":false,"name":"analyzeFunction","comment":"Analyze a function to build a stack frame based on stack references.","params":[{"type_long":"ghidra.program.model.listing.Function","name":"f","comment":"","type_short":"Function"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"the task monitor that is checked to see if the command has\n been cancelled.","type_short":"TaskMonitor"}],"throws":[{"type_long":"ghidra.util.exception.CancelledException","comment":"if the user canceled this command","type_short":"CancelledException"}],"return":{"type_long":"boolean","comment":"","type_short":"boolean"}},{"javadoc":"","static":false,"name":"isProtectedVariable","comment":"","params":[{"type_long":"ghidra.program.model.listing.Variable","name":"var","comment":"","type_short":"Variable"}],"throws":[],"return":{"type_long":"boolean","comment":"","type_short":"boolean"}},{"javadoc":"","static":false,"name":"addFunctionStackVariablesToSortedList","comment":"","params":[{"type_long":"ghidra.program.model.listing.Function","name":"func","comment":"","type_short":"Function"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"Create locals and parameters based on references involving purely the stack pointer.\n Pushes, Pops, and arithmetic manipulation of the stack pointer must be tracked.\n@param func - function to analyze stack pointer references","static":false,"name":"createStackPointerVariables","comment":"Create locals and parameters based on references involving purely the stack pointer.\n Pushes, Pops, and arithmetic manipulation of the stack pointer must be tracked.","params":[{"type_long":"ghidra.program.model.listing.Function","name":"func","comment":"- function to analyze stack pointer references","type_short":"Function"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"","type_short":"TaskMonitor"}],"throws":[{"type_long":"ghidra.util.exception.CancelledException","comment":"","type_short":"CancelledException"}],"return":{"type_long":"int","comment":"","type_short":"int"}},{"javadoc":"","static":false,"name":"addStackLocalVariables","comment":"","params":[{"type_long":"ghidra.program.model.listing.Function","name":"func","comment":"","type_short":"Function"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"},{"type_long":"ghidra.program.util.VariableStorageConflicts","name":"conflicts","comment":"","type_short":"VariableStorageConflicts"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"","type_short":"TaskMonitor"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"addStackParameters","comment":"","params":[{"type_long":"ghidra.program.model.listing.Function","name":"func","comment":"","type_short":"Function"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"},{"type_long":"ghidra.program.util.VariableStorageConflicts","name":"conflicts","comment":"","type_short":"VariableStorageConflicts"},{"type_long":"ghidra.util.task.TaskMonitor","name":"monitor","comment":"","type_short":"TaskMonitor"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"addMissingParameters","comment":"","params":[{"type_long":"ghidra.program.model.listing.Variable","name":"stackVar","comment":"","type_short":"Variable"},{"type_long":"int","name":"nextCopyParamIndex","comment":"","type_short":"int"},{"type_long":"ghidra.program.model.listing.Parameter[]","name":"oldParamList","comment":"","type_short":"ghidra.program.model.listing.Parameter[]"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"newParamList","comment":"","type_short":"List"},{"type_long":"ghidra.program.model.lang.PrototypeModel","name":"callingConvention","comment":"","type_short":"PrototypeModel"},{"type_long":"boolean","name":"hasStackParams","comment":"","type_short":"boolean"}],"throws":[],"return":{"type_long":"int","comment":"","type_short":"int"}},{"javadoc":"","static":false,"name":"getStackOpIndex","comment":"","params":[{"type_long":"ghidra.program.util.VarnodeContext","name":"context","comment":"","type_short":"VarnodeContext"},{"type_long":"ghidra.program.model.listing.Instruction","name":"cu","comment":"","type_short":"Instruction"},{"type_long":"int","name":"offset","comment":"","type_short":"int"}],"throws":[],"return":{"type_long":"int","comment":"","type_short":"int"}},{"javadoc":"Checks the indicated function in the program to determine if it is a jump thunk\n through a function pointer.\n@param func the function to check\n@param monitor status monitor for indicating progress and allowing cancel.\n@returntrue if check if this is a jump thunk through a function pointer","static":false,"name":"defineFuncVariable","comment":"Checks the indicated function in the program to determine if it is a jump thunk\n through a function pointer.","params":[{"type_long":"ghidra.program.model.listing.Function","name":"func","comment":"the function to check","type_short":"Function"},{"type_long":"ghidra.program.model.listing.Instruction","name":"instr","comment":"","type_short":"Instruction"},{"type_long":"int","name":"opIndex","comment":"","type_short":"int"},{"type_long":"int","name":"stackOffset","comment":"","type_short":"int"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"Look at the result register to try and figure out stack access size.\n@param instr instruction being analyzed\n@param opIndex operand that has a stack reference.\n@return size of value referenced on the stack","static":false,"name":"getRefSize","comment":"Look at the result register to try and figure out stack access size.","params":[{"type_long":"ghidra.program.model.listing.Instruction","name":"instr","comment":"instruction being analyzed","type_short":"Instruction"},{"type_long":"int","name":"opIndex","comment":"operand that has a stack reference.","type_short":"int"}],"throws":[],"return":{"type_long":"int","comment":"size of value referenced on the stack","type_short":"int"}},{"javadoc":"","static":false,"name":"getVariablesIntersecting","comment":"","params":[{"type_long":"int","name":"offset","comment":"","type_short":"int"},{"type_long":"int","name":"size","comment":"","type_short":"int"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"}],"throws":[],"return":{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","comment":"","type_short":"List"}},{"javadoc":"","static":false,"name":"getVariableContaining","comment":"","params":[{"type_long":"int","name":"offset","comment":"","type_short":"int"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"}],"throws":[],"return":{"type_long":"ghidra.program.model.listing.Variable","comment":"","type_short":"Variable"}},{"javadoc":"Add non-overlapping stack variable to sorted variable list.  \n The caller is responsible for ensuring that no overlap\/conflict\n with other variables in the list exist.\n@param var\n@param sortedVariables","static":false,"name":"addVariableToSortedList","comment":"Add non-overlapping stack variable to sorted variable list.  \n The caller is responsible for ensuring that no overlap\/conflict\n with other variables in the list exist.","params":[{"type_long":"ghidra.program.model.listing.Variable","name":"var","comment":"","type_short":"Variable"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"}],"throws":[],"return":{"type_long":"void","comment":"","type_short":"void"}},{"javadoc":"","static":false,"name":"accumulateVariable","comment":"","params":[{"type_long":"ghidra.program.model.listing.Function","name":"func","comment":"","type_short":"Function"},{"type_long":"int","name":"offset","comment":"","type_short":"int"},{"type_long":"int","name":"refSize","comment":"","type_short":"int"},{"type_long":"java.util.List<ghidra.program.model.listing.Variable>","name":"sortedVariables","comment":"","type_short":"List"}],"throws":[{"type_long":"ghidra.util.exception.InvalidInputException","comment":"","type_short":"InvalidInputException"}],"return":{"type_long":"void","comment":"","type_short":"void"}}],"name":"NewFunctionStackAnalysisCmd","comment":"Command for analyzing the Stack; the command is run in the background.\n NOTE: referenced thunk-functions should be created prior to this command","fields":[{"type_long":"int","javadoc":"","static":true,"name":"MAX_PARAM_OFFSET","comment":"","type_short":"int","constant_value":"2048"},{"type_long":"int","javadoc":"","static":true,"name":"MAX_LOCAL_OFFSET","comment":"","type_short":"int","constant_value":"-65536"},{"type_long":"ghidra.program.model.address.AddressSet","javadoc":"","static":false,"name":"entryPoints","comment":"","type_short":"AddressSet","constant_value":null},{"type_long":"ghidra.program.model.listing.Program","javadoc":"","static":false,"name":"program","comment":"","type_short":"Program","constant_value":null},{"type_long":"boolean","javadoc":"","static":false,"name":"forceProcessing","comment":"","type_short":"boolean","constant_value":null},{"type_long":"boolean","javadoc":"","static":false,"name":"dontCreateNewVariables","comment":"","type_short":"boolean","constant_value":null},{"type_long":"boolean","javadoc":"","static":false,"name":"doParams","comment":"","type_short":"boolean","constant_value":null},{"type_long":"boolean","javadoc":"","static":false,"name":"doLocals","comment":"","type_short":"boolean","constant_value":null},{"type_long":"ghidra.program.model.lang.Register","javadoc":"","static":false,"name":"stackReg","comment":"","type_short":"Register","constant_value":null},{"type_long":"int","javadoc":"","static":false,"name":"purge","comment":"","type_short":"int","constant_value":null},{"type_long":"java.lang.String","javadoc":"","static":true,"name":"DEFAULT_FUNCTION_COMMENT","comment":"","type_short":"String","constant_value":null},{"type_long":"int","javadoc":"","static":true,"name":"MAX_PARAM_FILLIN_COUNT","comment":"","type_short":"int","constant_value":"10"}]}
